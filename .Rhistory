student_mat <- read.csv("/Users/ollisilvennoinen/IODS-project/data/student_mat.csv")
student_mat <- read.csv("/Users/ollisilvennoinen/IODS-project/data/student-mat.csv")
student_por <- read.csv("/Users/ollisilvennoinen/IODS-project/data/student-por.csv")
str(student_mat)
student_mat <- read.csv("/Users/ollisilvennoinen/IODS-project/data/student-mat.csv", header = TRUE)
student_mat <- read.table("/Users/ollisilvennoinen/IODS-project/data/student-mat.csv", sep = ",", header = TRUE)
student_mat <- read.table("/Users/ollisilvennoinen/IODS-project/data/student-mat.csv", sep = ";", header = TRUE)
student_por <- read.table("/Users/ollisilvennoinen/IODS-project/data/student-por.csv", sep = ";", header = TRUE)
str(student_mat)
mat <- read.table("/Users/ollisilvennoinen/IODS-project/data/student-mat.csv", sep = ";", header = TRUE)
por <- read.table("/Users/ollisilvennoinen/IODS-project/data/student-por.csv", sep = ";", header = TRUE)
str(mat)
dim(mat)
str(por)
dim(por)
library(dplyr)
join_by <- c("school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery", "internet")
math_por <- inner_join(math, por, by = join_by, suffix = c(".math", ".por"))
mat_por <- inner_join(mat, por, by = join_by, suffix = c(".mat", ".por"))
glimpse(mat_por)
dim(mat_por)
alc <- select(math_por, one_of(join_by))
alc <- select(mat_por, one_of(join_by))
notjoined_columns <- colnames(mat)[!colnames(mat) %in% join_by]
for(column_name in notjoined_columns) {
two_columns <- select(mat_por, starts_with(column_name))
first_column <- select(two_columns, 1)[[1]]
if(is.numeric(first_column)) {
alc[column_name] <- round(rowMeans(two_columns))
} else {
# add the first column vector to the alc data frame
alc[column_name] <- first_column
}
}
alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
dim(alc)
?write.csv
write.csv(alc, "/Users/ollisilvennoinen/IODS-project/data/alc.csv")
knitr::opts_chunk$set(echo = TRUE)
read.table(/Users/ollisilvennoinen/IODS-project/data/alc.csv, header = TRUE)
read.table("/Users/ollisilvennoinen/IODS-project/data/alc.csv"", header = TRUE)
read.table("/Users/ollisilvennoinen/IODS-project/data/alc.csv", header = TRUE)
alc <- read.table("/Users/ollisilvennoinen/IODS-project/data/alc.csv", header = TRUE)
alc <- read.table("/Users/ollisilvennoinen/IODS-project/data/alc.csv", sep = ",", header = TRUE)
colnames(alc)
str(alc)
str(alc)
?read.table
plot(high_use, sex, data = alc)```
plot(high_use, sex, data = alc)
plot(alc$high_use, alc$sex)
boxplot(alc$high_use, alc$sex)
plot(alc$high_use, alc$sex)
alc$high_use ~ alc$sex
alc$high_use ~ alc$sex
xtabs(alc$high_use ~ alc$sex)
xtabs(alc$high_use, alc$sex)
?xtabs
xtabs(alc$high_use, alc$sex)
table(alc$high_use, alc$sex)
plot(alc$high_use, alc$age)
qqplot(alc$high_use, alc$age)
boxplot(alc$high_use, alc$age)
library(ggplot2)
g1 <- ggplot(alc, aes(x = high_use, y = age, col = sex))
g1 + geom_boxplot() + ylab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = age, y = high_use, col = sex))
g1 + geom_boxplot() + xlab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = age, y = high_use, col = sex))
g1 + geom_boxplot() + xlab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = age, y = high_use, col = sex))
g1 + geom_smooth() + xlab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = high_use, y = age, col = sex))
g1 + geom_smooth() + ylab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = high_use, y = age, col = sex))
g1 + geom_boxplot() + ylab("age")
library(ggplot2)
g1 <- ggplot(alc, aes(x = high_use, y = age))
g1 + geom_boxplot() + ylab("age")
g2 <- ggplot(alc, aex(x = high_use, y = Medu))
g2 <- ggplot(alc, aes(x = high_use, y = Medu))
g2 + geom_boxplot()
plot(high_use, Medu, data = alc)
plot(alc$high_use, alc$Medu)
table(alc$high_use, alc$Medu)
table(alc$high_use, alc$Medu)
table(alc$high_use, alc$Medu)
prop.table(alc$high_use, alc$Medu)
plot(table(alc$high_use, alc$Medu))
ggplot(alc, aes(x = G3, y = high_use, col = sex))
g2 <- ggplot(alc, aes(x = G3, y = high_use, col = sex))
g2 + geom_dotplot()
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
mean(G3, high_use)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
mean(G3, high_use, data = alc)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
mean(alc$G3, alc$high_use)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
mean(alc$G3)
?mean
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
mean(alc$G3, alc$high_use == TRUE)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
alc_true <- alc$high_use == TRUE
alc_false <- alc$high_use == FALSE
mean(alc_true$G3)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
alc_true <- filter(alc, high_use == TRUE)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
alc_true <- filter(alc, alc$high_use == TRUE)
alc_false <- filter(alc, alc$high_use == FALSE)
mean(alc_true$G3)
g2 <- ggplot(alc, aes(x = G3, col = high_use))
g2 + geom_dotplot()
m <- glm(high_use ~ sex + age + Medu + G3, data = alc, family = "binomial")
summary(m)
OR <- coef(m) %>% exp
library(dplyr)
OR <- coef(m) %>% exp
CI <- confint(m) %>% exp
cbind(OR, CI)
probabilities <- predict(m, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = alc$probability > 0.5)
table(high_use = alc$high_use, prediction = alc$probability > 0.5)
